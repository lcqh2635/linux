<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>图标优化的回到顶部</title>
    <!-- 使用ES模块方式引入lodash-es的throttle函数 -->
    <script type="importmap">
        {
            "imports": {
                "lodash-es/throttle": "https://cdn.jsdelivr.net/npm/lodash-es@4.17.21/throttle.js"
            }
        }
    </script>
    <!-- 引入Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #4361ee;
            --primary-hover: #3a56d4;
            --text-color: #2b2d42;
            --light-color: #f8f9fa;
            --shadow: 0 2px 10px rgba(0, 0, 0, 0.15);
            --transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background: linear-gradient(to bottom, #f5f7fa, #c3cfe2);
            min-height: 200vh;
            padding: 2rem;
        }

        h1 {
            text-align: center;
            margin: 2.5rem 0;
            color: var(--text-color);
            font-weight: 600;
        }

        .content {
            max-width: 800px;
            margin: 0 auto;
        }

        p {
            margin-bottom: 1.25rem;
            color: var(--text-color);
        }

        .back-to-top {
            position: fixed;
            right: 2rem;
            bottom: 2rem;
            z-index: 99;
            opacity: 0;
            visibility: hidden;
            transform: translateY(1rem);
            width: 3.125rem;
            height: 3.125rem;
            background-color: var(--primary-color);
            color: var(--light-color);
            border-radius: 50%;
            border: none;
            cursor: pointer;
            box-shadow: var(--shadow);
            transition: var(--transition);
            display: flex;
            justify-content: center;
            align-items: center;
            outline: none;
        }

        .back-to-top.show {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .back-to-top:hover,
        .back-to-top:focus {
            background-color: var(--primary-hover);
            transform: translateY(-0.25rem);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        /* Font Awesome 图标样式 */
        .fa-arrow-up {
            font-size: 1.25rem;
        }

        /* SVG 图标样式 - 备用方案 */
        .back-to-top svg {
            width: 1.25rem;
            height: 1.25rem;
            fill: currentColor;
        }

        @media (max-width: 768px) {
            .back-to-top {
                width: 2.5rem;
                height: 2.5rem;
                right: 1rem;
                bottom: 1rem;
            }

            .fa-arrow-up,
            .back-to-top svg {
                font-size: 1rem;
                width: 1rem;
                height: 1rem;
            }
        }

        @media (prefers-reduced-motion: reduce) {
            .back-to-top {
                transition: none;
            }
        }
    </style>
</head>
<body>
<h1>图标优化的回到顶部按钮</h1>

<div class="content">
    <p>这个版本使用了Font Awesome图标和SVG备用方案，视觉效果更专业。</p>

    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam in dui mauris. Vivamus hendrerit arcu sed erat molestie vehicula. Sed auctor neque eu tellus rhoncus ut eleifend nibh porttitor. Ut in nulla enim. Phasellus molestie magna non est bibendum non venenatis nisl tempor. Suspendisse dictum feugiat nisl ut dapibus.</p>
    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam in dui mauris. Vivamus hendrerit arcu sed erat molestie vehicula. Sed auctor neque eu tellus rhoncus ut eleifend nibh porttitor. Ut in nulla enim. Phasellus molestie magna non est bibendum non venenatis nisl tempor. Suspendisse dictum feugiat nisl ut dapibus.</p>
    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam in dui mauris. Vivamus hendrerit arcu sed erat molestie vehicula. Sed auctor neque eu tellus rhoncus ut eleifend nibh porttitor. Ut in nulla enim. Phasellus molestie magna non est bibendum non venenatis nisl tempor. Suspendisse dictum feugiat nisl ut dapibus.</p>
    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam in dui mauris. Vivamus hendrerit arcu sed erat molestie vehicula. Sed auctor neque eu tellus rhoncus ut eleifend nibh porttitor. Ut in nulla enim. Phasellus molestie magna non est bibendum non venenatis nisl tempor. Suspendisse dictum feugiat nisl ut dapibus.</p>
    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam in dui mauris. Vivamus hendrerit arcu sed erat molestie vehicula. Sed auctor neque eu tellus rhoncus ut eleifend nibh porttitor. Ut in nulla enim. Phasellus molestie magna non est bibendum non venenatis nisl tempor. Suspendisse dictum feugiat nisl ut dapibus.</p>
</div>

<!-- 回到顶部按钮 - 使用Font Awesome图标和SVG备用 -->
<button class="back-to-top" aria-label="回到顶部" title="回到顶部">
    <!-- Font Awesome 图标 -->
    <i class="fas fa-arrow-up"></i>

    <!-- SVG 备用图标 (在Font Awesome加载失败时显示) -->
    <svg class="svg-icon" style="display: none;" viewBox="0 0 24 24" aria-hidden="true">
        <path d="M12 4l-8 8h5v8h6v-8h5z"/>
    </svg>
</button>

<script type="module">
    // 导入lodash-es的throttle函数
    import throttle from 'lodash-es/throttle';

    document.addEventListener('DOMContentLoaded', function() {
        const backToTopButton = document.querySelector('.back-to-top');
        const scrollThreshold = 300;

        // 检测Font Awesome是否加载成功
        function checkFontAwesomeLoaded() {
            // 创建一个测试元素
            const test = document.createElement('div');
            test.className = 'fa fa-arrow-up';
            test.style.position = 'absolute';
            test.style.top = '-9999px';
            test.style.left = '-9999px';
            document.body.appendChild(test);

            // 获取计算后的样式
            const style = window.getComputedStyle(test, ':before');
            const content = style.getPropertyValue('content');

            // 移除测试元素
            document.body.removeChild(test);

            // 如果content不是none，说明Font Awesome已加载
            return content && content !== 'none';
        }

        // 如果Font Awesome未加载，显示SVG图标
        if (!checkFontAwesomeLoaded()) {
            const faIcon = backToTopButton.querySelector('.fa-arrow-up');
            const svgIcon = backToTopButton.querySelector('.svg-icon');

            if (faIcon && svgIcon) {
                faIcon.style.display = 'none';
                svgIcon.style.display = 'block';
            }
        }

        // 使用lodash的throttle函数包装滚动处理
        const handleScroll = throttle(() => {
            if (window.pageYOffset > scrollThreshold) {
                backToTopButton.classList.add('show');
            } else {
                backToTopButton.classList.remove('show');
            }
        }, 100);

        // 添加滚动事件监听
        window.addEventListener('scroll', handleScroll, { passive: true });

        // 平滑滚动到顶部
        backToTopButton.addEventListener('click', (e) => {
            e.preventDefault();
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
            backToTopButton.blur();
        });

        // 键盘可访问性
        backToTopButton.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                e.preventDefault();
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            }
        });
    });
</script>
</body>
</html>